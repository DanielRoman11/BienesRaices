extends ../layout/admin

block contenido
  .h2(class="text-[#142906] text-center text-2xl font-bold")= pagina
  .flex.pt-10
    a(class="sm:max-w-[450px] lg:max-w-[500px] m-auto bg-[#142906] px-10 sm:px-20 py-2 focus:outline-none focus:delay-75 focus:ring-4 focus:ring-opacity-75 text-xs md:text-base ring-yellow-200 w-4/5 sm:w-2/3 text-center md:w-auto md:mb-5 rounded-md text-[#FDFBF6] font-bold hover:skew-y-1 transition-all hover:duration-75" href="/propiedades/crear") Publica una propiedad🏠

  pre= JSON.stringify(propiedades, undefined, 3)
  if propiedades.length
    div(class="w-full flex justify-center gap-2 flex-wrap pt-10 pb-20")
      each propiedad in propiedades
        article(class="bg-white w-4/5 sm:w-2/3 h-full sm:h-[460px] max-w-[425px] md:w-2/5 lg:w-1/3 rounded-md overflow-hidden border-2 border-gray-300 hover:border-[#142906] hover:shadow-xl")
          div(class="flex h-1/2 relative")
            img(src= propiedad.imagenes.length > 0 ? propiedad.imagenes[0].ruta : "https://res.cloudinary.com/dakerpersonalspace/image/upload/v1707755538/kgzjptrvcz3xcmlgmclt.webp" alt=`Imagen para la propiedad ${propiedad.titulo}` class="block w-full flex-grow basis-0")
            p(class="absolute top-2 left-2 flex items-center text-ellipsis font-bold whitespace-pre-line overflow-hidden text-sm bg-white/20 backdrop-blur rounded-md px-4 py-1")
              include ../svg/propiedadSVG
              = propiedad.categoria.nombre
            a(class=`absolute right-2 top-2 z-10 cursor-pointer  backdrop-blur-md rounded-full p-2 flex ${propiedad.mensajes.length < 1 ? "text-white bg-slate-700/60" : "text-green-600 bg-green-100"}` href="")
              if propiedad.mensajes.length < 1
                include ../svg/emptyMessage
              else
                include ../svg/fullMessage
                p.text-red-500.font-semibold= propiedad.mensajes.length
          div(class="space-y-3 p-3 truncate flex flex-col justify-between h-1/2 ")
            div.h-fit
              a(class="text-base sm:text-lg font-bold text-[#142906]" href=`propiedades/propiedad/${propiedad.id}`)= "➡️ "+propiedad.titulo
            div(class="flex flex-col text-sm h-full")
              p(class="text-ellipsis font-bold whitespace-pre-line overflow-hidden flex text-[#142906]")= propiedad.precio.nombre
              p(class=" font-semibold text-gray-600")= propiedad.calle
            div(class="flex gap-2 sm:w-auto flex-col sm:flex-row sm:justify-center")
              form(action="#")
                input(type="submit" class=`px-2 py-2 md:py-1 text-xs w-full sm:w-auto leading-5 font-semibold rounded-md cursor-pointer ${propiedad.publicado ? 'bg-green-200 text-green-800' : 'bg-orange-200 text-orange-800'}` value=`${propiedad.publicado ? 'Publicado' : 'No publicado'}`)
              a(href=`propiedades/editar/${propiedad.id}` class="px-2 py-2 md:py-1 text-center text-xs leading-5 font-semibold rounded-md cursor-pointer bg-blue-200") Editar

              form(method="post" action=`/propiedades/eliminar/${propiedad.id}`)
                //- input(type="hidden", name="_csrf" value= csrfToken)
                input(type="submit" class="px-2 py-2 md:py-1 text-xs w-full sm:w-auto leading-5 font-semibold rounded-md cursor-pointer bg-red-200 text-red-800" value="Eliminar")
    div(class="fixed w-full bottom-0 inset-x-0 bg-white/0 backdrop-blur-2xl p-2 flex items-center justify-evenly border-t border-gray-400 sm:px-6 overflow-x-auto gap-2")
      div(class="flex flex-1 justify-between sm:hidden")
        
        a(href=`/propiedades?pagina=${paginaActual - 1}` class=`${paginaActual == 1 ? 'pointer-events-none bg-pink-50 border-pink-500 text-pink-500 hover:bg-pink-200' : ""} `+" relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50") Anterior

        a(href=`/propiedades?pagina=${paginaActual + 1}` class=`${paginaActual + 1 > paginas ? 'pointer-events-none bg-pink-50 border-pink-500 text-pink-500 hover:bg-pink-200' : ""}`+"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50") Siguiente
      div(class="hidden sm:flex w-2/5 sm:flex-1 sm:items-center sm:justify-between")
        p(class="text-xs md:text-md lg:text-lg text-pink-800 gap-2") Mostrando de 
          span(class="font-bold text-pink-800") #{offset + 1} 
            span.font-normal a 
          span(class="font-bold") #{limit * paginaActual < total ? limit * paginaActual : total} propiedades   
            span.font-normal de 
          span(class="font-bold") #{total} encontradas.
      div(class="hidden sm:block overflow-auto w-3/5")
        nav(class="z-0 flex justify-center rounded-md space-x-2")
          - var n = 1;
            while n <= paginas
              a(href=`/propiedades?pagina=${n}` class=`${paginaActual == n ? 'bg-pink-50 border-pink-500 text-pink-500 hover:bg-pink-200' : 'bg-white border border-gray-400 hover:bg-gray-100'} relative inline-flex items-center px-4 py-1 border text-sm font-medium rounded-sm shadow-2xl`) #{n++}
  else
    p.text-center.font-bold.text-2xl(class="text-[#142906]") No hay propiedades